"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[2407],{72407:function(t,e,i){i.r(e),i.d(e,{default:function(){return w}});i(49282);var n=i(47297),o=i(66252),a=i(2262),l=i(49963),r=i(3577),c=i(60191),u=i(78582),d=i(73974),s=i(27959),m=i(9173),g=i(83925);i(74916),i(23123),i(41539),i(78783),i(33948),i(60285),i(41637);function v(t){var e=t.lastIndexOf("/")+1,i=t.substring(e);return i=decodeURI(i.split("?")[0])}var f=["src","onLoad"],h=["src"],S={key:0,class:"toolbar"},p=(0,o.aZ)({props:{visible:{type:Boolean,default:!1},type:{default:"image"},url:{default:""}},emits:["update:visible"],setup:function(t,e){var i,p=e.emit,w=t,y=(0,a.iH)(),k=(0,a.qj)({timer:null,loading:!1,rotateDeg:0,imgScale:1,scaleCV:.07,initWidth:0,initHeight:0,contentStyle:{width:"60vw",height:"60vh"},imgStyle:{width:"",height:"",transform:"rotate(0)"}}),U=(0,a.Fl)({get:function(){return w.visible},set:function(t){return p("update:visible",t)}}),C=function(){k.rotateDeg-=90,k.imgStyle.transform="rotate(".concat(k.rotateDeg,"deg)")},b=function(t){!function(t){var e=t.url,i=t.target,n=void 0===i?"_blank":i,o=t.fileName,a=new URL(e).host==location.host;new Promise((function(t,i){if(a){var l=document.createElement("a");if(l.href=e,l.target=n,void 0!==l.download&&(l.download=o||v(e)),document.createEvent){var r=document.createEvent("MouseEvents");return r.initEvent("click",!0,!0),l.dispatchEvent(r),t(!0)}return-1===e.indexOf("?")&&(e+="?download"),window.open(e,n),t(!0)}var c=document.createElement("canvas"),u=document.createElement("img");u.setAttribute("crossOrigin","Anonymous"),u.src=e,u.onload=function(i){c.width=u.width,c.height=u.height,c.getContext("2d").drawImage(u,0,0,u.width,u.height),c.toBlob((function(i){var n=document.createElement("a");n.href=window.URL.createObjectURL(i),n.download=v(e),n.click(),URL.revokeObjectURL(n.href),t(!0)}),"image/jpeg")},u.onerror=function(t){return i(t)}}))}({url:t})},W=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scale";k.imgStyle.width=k.initWidth*k.imgScale+"px",k.imgStyle.height=k.initHeight*k.imgScale+"px","init"===e?(k.imgStyle.maxWidth="",k.imgStyle.maxHeight=""):(k.imgStyle.maxWidth="none!important",k.imgStyle.maxHeight="none!important"),clearTimeout(i),i=setTimeout((function(){var t;return null===(t=y.value)||void 0===t?void 0:t.classList.remove("active")}),1400),null===(t=y.value)||void 0===t||t.classList.add("active"),k.contentStyle={}},L=function(){k.imgScale=1,W()},x=function(){k.imgScale+=k.scaleCV,W()},E=function(){k.imgScale-=k.scaleCV,W()},_=function(t){var e;if(null!==(e=t.currentTarget)&&void 0!==e&&e.complete){var i=getComputedStyle(t.currentTarget),n=i.width,o=i.height;k.imgStyle.width=n,k.imgStyle.height=o,k.initWidth=parseFloat(n),k.initHeight=parseFloat(o)}};return function(e,i){return(0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,a.SU)(U)?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"preview-modal",onClick:i[4]||(i[4]=(0,l.iM)((function(t){return U.value=!1}),["self"]))},[(0,o.Wm)((0,a.SU)(c.Z),{class:"close-icon",onClick:i[0]||(i[0]=function(t){return U.value=!1})}),(0,o._)("div",{class:"preview-content",style:(0,r.j5)((0,a.SU)(k).contentStyle)},[(0,o.Wm)((0,a.SU)(n.Z),{spinning:(0,a.SU)(k).loading},{default:(0,o.w5)((function(){return["image"===t.type?((0,o.wg)(),(0,o.iD)("img",{key:0,ref:"img",style:(0,r.j5)((0,a.SU)(k).imgStyle),src:t.url,alt:"",onLoad:(0,l.iM)(_,["stop"])},null,44,f)):(0,o.kq)("",!0),"video"===t.type?((0,o.wg)(),(0,o.iD)("video",{key:1,ref:"video",src:t.url,controls:"",autoplay:"",onCanplay:i[1]||(i[1]=function(t){return(0,a.SU)(k).loading=!1}),onLoadstart:i[2]||(i[2]=function(t){return(0,a.SU)(k).loading=!0})},null,40,h)):(0,o.kq)("",!0),(0,o._)("div",{ref_key:"imgScaleMask",ref:y,class:"img-scale-mask"},(0,r.zw)(~~(100*(0,a.SU)(k).imgScale)+"%"),513)]})),_:1},8,["spinning"])],4),"image"===t.type?((0,o.wg)(),(0,o.iD)("div",S,[(0,o.Wm)((0,a.SU)(u.Z),{title:"放大",onClick:x}),(0,o.Wm)((0,a.SU)(d.Z),{title:"缩放",onClick:E}),(0,o.Wm)((0,a.SU)(s.Z),{title:"原始比例",onClick:L}),(0,o.Wm)((0,a.SU)(m.Z),{title:"旋转",onClick:C}),(0,o.Wm)((0,a.SU)(g.Z),{title:"下载",onClick:i[3]||(i[3]=function(e){return b(t.url)})})])):(0,o.kq)("",!0)])):(0,o.kq)("",!0)])}}});var w=p}}]);